#also fuck this bitch he made this needlessly complicated
sbox = {
    0x0: 0x9, 0x1: 0xE, 0x2: 0x5, 0x3: 0x0,
    0x4: 0x7, 0x5: 0xF, 0x6: 0x1, 0x7: 0x2,
    0x8: 0x8, 0x9: 0xA, 0xA: 0x6, 0xB: 0xD,
    0xC: 0xB, 0xD: 0x4, 0xE: 0xC, 0xF: 0x3
}

ciphertext = [
    0x6,0x1,0x2,0x6,0x2,0xC,0x7,0xE,0x2,0x6,
    0xD,0xA,0x7,0x6,0x4,0xF,0xA,0x6,0x6,0x1,
    0xD,0xC,0xA,0xB,0xA,0x8,0x3,0x2,0xA,0x9,
    0xA,0xE,0x3,0xF,0xD,0x8,0x2,0x7
]

after_sbox = [sbox[c] for c in ciphertext]

pairs = [(after_sbox[i] << 4) | after_sbox[i+1] for i in range(0, len(after_sbox), 2)] #shifts so its like 8 bytes rather than 4 {who cud have guessed jayden is this smart honestly}

key = [0x58, 0x30, 0x35] #xors with key
result = bytes([b ^ key[i % 3] for i, b in enumerate(pairs)])

print("Flag:", result.decode())
