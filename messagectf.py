def iroot(n, k):
    """Integer k-th root via Newton's method."""
    if n == 0: return 0, True
    bits = n.bit_length()
    x = 1 << ((bits + k - 1) // k)
    while True:
        xk1 = x ** (k - 1)
        x1 = ((k - 1) * x + n // xk1) // k
        if x1 >= x:
            break
        x = x1
    for candidate in [x - 1, x, x + 1]:
        if candidate >= 0 and candidate ** k == n:
            return candidate, True
    return x, False


e = 25

ns = [
    108596648084018632994755541523973550092443126083313978331669654914997512597562339072048121328662938474892069724325391375340428445109074853759989121119690010117520485433748147220587797730830910423569617281769231242754267033715744195033475366790623856312924030402224938671954021188821851241237609824933906180127,
    96707441955781864457673765662714335119255516621671125218854073363339942125737005117555177369995668393791457457060376981650251298526706366818078816503249382115186390447772034453221633621473628649221878472612326354969577505764854115584961202650098753612160806392286769075872392175837493341609712077756425770999,
    110388687966461681834315427606595877100654177725725811011776845705720964434316191081349784116180514597199324603148752774986892288322335610491009851692467321166488862742398657051285412725363689128296628123234689608667356471096688943346827373577130039070034789454786452235799767397950501638622948974310496445307
]

ciphers = [
    20252944032911657759329626221664626514115417798828523246687422382458298900402604923827587334337195403315027550601765455883694023338249079972159819675667029467040522521374038434200373832989919599163927488598495122546372955457705542281966248754591891535871857743234572558464020602830867194642031594394512086004,
    30918310672089897726460315184791431060619373541992912543451986934820862376440655079984707346513831164446409108744946646290052262022820126627717897178068509063337508359866249147013722774525327452421311238930765143619496194382080547866902439324110464026898641810358471059628497461179544137331094973003472747264,
    43036795660371392783820248228416205255837294469503872798472972905302694585224411316610281004196214017805836439553696878393082864665985206186318432134654331399599833087378620090625002420242811388437205443197003955268273339926239983187254580284276665963662347755846097550411699364862458981046127804958920640624
]

N = 1
for n in ns:
    N *= n

x = 0
for i in range(len(ns)):
    Ni = N // ns[i]
    inv = pow(Ni, -1, ns[i])
    x = (x + ciphers[i] * Ni * inv) % N

m, exact = iroot(x, e)
print(f"Exact root: {exact}")
print(f"Plaintext (int): {m}")

s = str(m)
pairs = [int(s[i:i+2]) for i in range(0, len(s), 2)]
decoded = ''.join(chr(65 + p) if p < 26 else ' ' for p in pairs)
print(f"Decoded message: {decoded}")